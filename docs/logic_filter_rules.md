# 逻辑条件字典使用说明

## 1. 基本思想

在条件筛选中：

同级条件之间默认是 AND（与）关系，用字典直接写即可。

OR（或）关系 需要显式用 "OR": [...] 块表示。

条件可以嵌套，允许括号式分组逻辑 (A+B)C、(A+B)(C+D)+E 等。

条件字母直接写成 A、B 这种形式表示一个最小筛选条件。扩充为"A": xxx, "B": xxx, 等。

可以用 !A 表示条件取反。即"!A": xxx

这种写法的重点是：

AND 是默认关系（流水线式筛选），所以不需要 "AND" 关键字。

OR 才是显式定义的特殊块，因为实际业务中 AND 出现频率更高。

## 2. 逻辑运算到字典的映射

| 逻辑表达式             | 规则字典写法                                                        |
|-------------------|---------------------------------------------------------------|
| `A+B`             | `{"OR": [ {A}, {B} ]}`                                        |
| `AB`              | `{ A, B }`                                                    |
| `(A+B)C`          | `{ "OR": [ {A}, {B} ], C }`                                   |
| `(A+BC)D`         | `{ "OR": [ {A}, {B, C} ], D }`                                |
| `(A+B)(C+D)`      | `{ "OR1": [ {A}, {B} ], "OR2": [ {C}, {D} ] }`                |
| `(A+B)(C+D)+E`    | `{"OR": [ {"OR1": [ {A}, {B} ], "OR2": [ {C}, {D} ]}, {E} ]}` |
| `!A+B`            | `{"OR": [ {"!A"}, {B} ]}`                                     |
| `!(A+B)` → `!A!B` | `{ "!A", "!B" }`                                              |

## 3. 写法规则

### 与条件（AND）

多个条件并列写在同一个字典里：

```plaintext 
{A, B, C}
```

表示同时满足 A、B、C。

### 或条件（OR）

多个分支写成 {"OR": [ {条件组1}, {条件组2}, ... ]}：

```plaintext 
{"OR": [ {A}, {B, C} ]}
```

表示 (A + BC)。

### 嵌套 OR（括号）

每一个 "OR": [...] 相当于加了一层括号，括号内条件之间的 AND 默认用字典合并：

```plaintext 
{ "OR": [ {"OR": [ {A}, {B} ], C }, {D} ] }
```

表示 (A+B)C + D。

### 多组 OR

可以有多个 OR 块同时存在，分别独立过滤：

```plaintext 
{ "OR1": [ {A}, {B} ], "OR2": [ {C}, {D} ] }
```

表示 (A+B)(C+D)。

### 取反（NOT）

在条件前加 !：

```plaintext 
{"!A", B}
```

表示 !A B（即满足 B 且不满足 A）。

不支持 "!OR"，因为可以通过德摩根律转换，例如：

!(A+B) → !A !B

!(AB) → !A + !B

### 复杂示例

逻辑表达式：

```mathematica
(A+B)C + (D+!E)F
```

转为：

```plaintext 
{
    "OR": [
        { "OR": [ {A}, {B} ], C },
        { "OR": [ {D}, {"!E"} ], F }
    ]
}
```